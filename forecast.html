<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pioneer 2027 Hybrid Forecast</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f5f5f5; }
        .header {
            background: linear-gradient(135deg, #1a5f2a, #134620);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header h1 { font-size: 1.4rem; }
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        .btn-primary { background: white; color: #1a5f2a; font-weight: 600; }
        .btn-secondary { background: rgba(255,255,255,0.2); color: white; }
        .btn:hover { opacity: 0.9; }
        .container { max-width: 1400px; margin: 0 auto; padding: 1.5rem; }
        .tabs {
            display: flex;
            gap: 0;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #1a5f2a;
        }
        .tab {
            padding: 0.75rem 1.5rem;
            background: #e8e8e8;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
        }
        .tab.active { background: #1a5f2a; color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .section {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
        }
        .section h2 {
            font-size: 1.1rem;
            color: #1a5f2a;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e8f5e9;
        }
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .summary-card {
            background: linear-gradient(135deg, #1a5f2a, #2d8a42);
            color: white;
            padding: 1.25rem;
            border-radius: 8px;
            text-align: center;
        }
        .summary-card .label { font-size: 0.8rem; opacity: 0.9; margin-bottom: 0.25rem; }
        .summary-card .value { font-size: 2rem; font-weight: bold; }
        .summary-card .sub { font-size: 0.75rem; opacity: 0.8; margin-top: 0.25rem; }
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        th, td { padding: 0.6rem 0.75rem; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f8f8; font-weight: 600; color: #333; position: sticky; top: 0; }
        tr:hover { background: #f9f9f9; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }
        .prediction { color: #1a5f2a; font-weight: 600; }
        .change-up { color: #28a745; }
        .change-down { color: #dc3545; }
        .data-table-container {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        .filter-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .filter-row select, .filter-row input {
            padding: 0.4rem 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.85rem;
        }
        /* 2027 New Hybrids Section */
        .hybrid-card {
            background: white;
            border: 2px solid #1a5f2a;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .hybrid-card h3 {
            color: #1a5f2a;
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .hybrid-card .crm-badge {
            background: #007bff;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        .hybrid-card .replaces {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        .hybrid-specs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .spec-item {
            background: #f8f8f8;
            padding: 0.75rem;
            border-radius: 4px;
        }
        .spec-item .label { font-size: 0.75rem; color: #666; }
        .spec-item .value { font-size: 1rem; font-weight: 600; color: #1a5f2a; }
        .hybrid-notes {
            margin-top: 1rem;
        }
        .hybrid-notes label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333;
        }
        .hybrid-notes textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
            min-height: 80px;
            resize: vertical;
        }
        .key-notes {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .key-notes h4 { color: #856404; margin-bottom: 0.5rem; }
        .key-notes ul { margin-left: 1.5rem; color: #856404; }
        /* Print styles */
        @media print {
            body { background: white; }
            .header, .tabs, .filter-row, .summary-cards, .btn { display: none !important; }
            .container { max-width: 100%; padding: 0; margin: 0; }
            .tab-content { display: none !important; }
            .tab-content.print-active { display: block !important; }
            .section { box-shadow: none; padding: 0; margin: 0; }
            .data-table-container { max-height: none; overflow: visible; border: none; }
            table { font-size: 10pt; }
            th, td { padding: 4px 8px; border: 1px solid #333; }
            th { background: #e8e8e8 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .prediction { color: #1a5f2a !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .print-header { display: block !important; text-align: center; margin-bottom: 1rem; }
            .print-header h1 { font-size: 16pt; color: #1a5f2a; margin-bottom: 0.25rem; }
            .print-header p { font-size: 10pt; color: #666; }
            .print-summary { display: flex !important; justify-content: space-around; margin-bottom: 1rem; padding: 0.5rem; border: 1px solid #ddd; }
            .print-summary span { font-size: 10pt; }
            .print-summary strong { color: #1a5f2a; }
        }
        .print-header, .print-summary { display: none; }
    </style>
</head>
<body>
    <!-- Auth check -->
    <script src="js/auth.js"></script>

    <div class="header">
        <h1>Pioneer 2027 Hybrid Quantity Forecast</h1>
        <div style="display:flex; gap:0.5rem; align-items:center;">
            <a href="members.html" class="btn btn-primary" style="text-decoration:none;">Home</a>
            <a href="yield-zone.html" class="btn btn-secondary" style="text-decoration:none;">Yield Zones</a>
            <a href="sorghum.html" class="btn btn-secondary" style="text-decoration:none;">Sorghum</a>
            <a href="soybeans.html" class="btn btn-secondary" style="text-decoration:none;">Soybeans</a>
            <button class="btn btn-primary" onclick="exportData()">Export Forecast</button>
            <button class="btn btn-secondary" onclick="localStorage.removeItem('memberAuth'); window.location.href='index.html';">Logout</button>
        </div>
    </div>
    <div class="container">
        <div class="summary-cards">
            <div class="summary-card">
                <div class="label">2024 Total</div>
                <div class="value" id="total-2024">0</div>
                <div class="sub">bags</div>
            </div>
            <div class="summary-card">
                <div class="label">2025 Total</div>
                <div class="value" id="total-2025">0</div>
                <div class="sub">bags</div>
            </div>
            <div class="summary-card">
                <div class="label">2026 Total</div>
                <div class="value" id="total-2026">0</div>
                <div class="sub">bags</div>
            </div>
            <div class="summary-card" style="background: linear-gradient(135deg, #0056b3, #007bff);">
                <div class="label">2027 Predicted</div>
                <div class="value" id="total-2027">0</div>
                <div class="sub">bags</div>
            </div>
        </div>
        <div class="tabs">
            <button class="tab active" onclick="switchTab('by-operation')">By Operation</button>
            <button class="tab" onclick="switchTab('by-hybrid')">By Hybrid</button>
            <button class="tab" onclick="switchTab('detail')">Detail View</button>
            <button class="tab" onclick="switchTab('new-hybrids')">2027 New Hybrids</button>
            <button class="tab" onclick="switchTab('competitive')">Competitive</button>
        </div>
        <div id="by-operation" class="tab-content active">
            <div class="section">
                <h2>Quantity by Operation (Grower)</h2>
                <div class="filter-row">
                    <input type="text" id="filter-operation" placeholder="Filter operations..." oninput="renderByOperation()">
                </div>
                <div class="data-table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Operation</th>
                                <th class="text-right">2024</th>
                                <th class="text-right">2025</th>
                                <th class="text-right">2026</th>
                                <th class="text-right prediction">2027 Predicted</th>
                                <th class="text-right">Change</th>
                            </tr>
                        </thead>
                        <tbody id="operation-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="by-hybrid" class="tab-content">
            <div class="section">
                <h2>Quantity by Hybrid</h2>
                <div class="filter-row">
                    <input type="text" id="filter-hybrid" placeholder="Filter hybrids..." oninput="renderByHybrid()">
                </div>
                <div class="data-table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Hybrid</th>
                                <th class="text-right">2024</th>
                                <th class="text-right">2025</th>
                                <th class="text-right">2026</th>
                                <th class="text-right prediction">2027 Predicted</th>
                                <th class="text-right">% of Total</th>
                            </tr>
                        </thead>
                        <tbody id="hybrid-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="detail" class="tab-content">
            <div class="print-header">
                <h1>Pioneer 2027 Hybrid Quantity Forecast</h1>
                <p>Detail View: Quantity by Operation + Hybrid</p>
            </div>
            <div class="print-summary">
                <span>2024 Total: <strong id="print-2024">0</strong> bags</span>
                <span>2025 Total: <strong id="print-2025">0</strong> bags</span>
                <span>2026 Total: <strong id="print-2026">0</strong> bags</span>
                <span>2027 Predicted: <strong id="print-2027">0</strong> bags</span>
            </div>
            <div class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 style="margin-bottom: 0; border-bottom: none; padding-bottom: 0;">Detail: Quantity by Operation + Hybrid</h2>
                    <button class="btn btn-primary" onclick="printDetailView()">Print Detail View</button>
                </div>
                <div class="filter-row">
                    <input type="text" id="filter-detail" placeholder="Filter..." oninput="renderDetail()">
                </div>
                <div class="data-table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Operation</th>
                                <th>Hybrid</th>
                                <th class="text-right">2024</th>
                                <th class="text-right">2025</th>
                                <th class="text-right">2026</th>
                                <th class="text-right prediction">2027 Predicted</th>
                            </tr>
                        </thead>
                        <tbody id="detail-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="new-hybrids" class="tab-content">
            <div class="hybrid-card">
                <h3>P96567V / P96567PCE <span class="crm-badge">96 CRM</span></h3>
                <div class="replaces">Replaces: P95819V</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Key Strength</div>
                        <div class="value">Drought Tolerance</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Maturity</div>
                        <div class="value">96 Days</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Technology</div>
                        <div class="value">V/PCE Options</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Best Fit</div>
                        <div class="value">Dryland / Limited Irrigation</div>
                    </div>
                </div>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P96567" onchange="saveNotes('P96567', this.value)" placeholder="Add your notes about P96567V/PCE here..."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P99491V / P99491PCE <span class="crm-badge">99 CRM</span></h3>
                <div class="replaces">Replaces: P9955V (corn-on-corn), P00549PCE (rotated acres)</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Hi-Yield BLUP</div>
                        <div class="value">~242 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Stress BLUP</div>
                        <div class="value">~208 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Maturity</div>
                        <div class="value">99 Days</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Performance</div>
                        <div class="value">Top Quadrant (Stress + Yield)</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>vs Competition:</strong> Outperforms P9845PWE, P00549YHRCE, P03357PWUE, P0075YHRCR in Stress x Hi-Yield chart<br>
                    <strong>vs P00549YHRCE:</strong> +15.0 bu/a, 82.4% wins (17 locations, p=0.02)
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P99491" onchange="saveNotes('P99491', this.value)" placeholder="Add your notes about P99491V/PCE here..."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P03802PCE <span class="crm-badge">103 CRM</span></h3>
                <div class="replaces">Replaces: P03951PCE (under irrigation), P0487PCE (better dryland); Companion to P03357PCUE</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Hi-Yield BLUP</div>
                        <div class="value">~244 bu/a (Top)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Plant Height</div>
                        <div class="value">Taller Plant (5)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Test Weight</div>
                        <div class="value">Below Avg (4)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Drought</div>
                        <div class="value">7</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> Top-end yield on better dryland to high-yield irrigated, attractive relaxed canopy that shades rows well, strong roots, decent ear flex - nice chunky ears<br>
                    <strong>Considerations:</strong> Below avg test weight, below avg head smut tolerance (avoid fields with smut history), will tiller in low pop<br>
                    <strong>vs P03357PWUE:</strong> +4.3 bu/a, 68.8% wins (32 locations)
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P03802" onchange="saveNotes('P03802', this.value)" placeholder="Your notes: Attractive plant, major player in good dryland to high yield. Goes over sand hills - take it to dryland to compete."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P04651V <span class="crm-badge">104 CRM</span> <span style="background:#007bff;color:white;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.7rem;margin-left:0.5rem;">AquaMax</span></h3>
                <div class="replaces">Replaces: P0075Q, P0487Q, P0622Q; Companion to P03357PCUE, P03115V</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Drought Rating</div>
                        <div class="value" style="color:#28a745;">9 (Excellent)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Best Environment</div>
                        <div class="value">220-250 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Staygreen</div>
                        <div class="value">7 (Good)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Head Smut</div>
                        <div class="value">2 (Avoid history)</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> AquaMax Vorceed - top-notch drought tolerance, solid yield potential, durability and stability for tough to moderate acres, excellent drought observations in 2025<br>
                    <strong>Positioning:</strong> Corn-on-corn dryland to full irrigation - shines in moderate acre down to dryland<br>
                    <strong>Considerations:</strong> Tends to produce longer silks, below avg head smut tolerance, slightly below avg stress emergence
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P04651" onchange="saveNotes('P04651', this.value)" placeholder="Your notes: AquaMax product. Will shine in moderate acre down to dryland. Really at home at 220-250 yield environment."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P08215PCUE <span class="crm-badge">108 CRM</span> <span style="background:#007bff;color:white;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.7rem;margin-left:0.5rem;">AquaMax</span></h3>
                <div class="replaces">Targeted Replacement: P0995AM; Dryland companion: P05081PCUE, P11259PCE; Durability companion: P09076VPCE, P10625PCUE</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Drought Rating</div>
                        <div class="value" style="color:#28a745;">9 (Excellent)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Stress BLUP</div>
                        <div class="value" style="color:#28a745;">~168 bu/a (Top tier)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Hi-Yield BLUP</div>
                        <div class="value">~241 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Test Weight</div>
                        <div class="value">7 (Good)</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> AquaMax with excellent drought tolerance (9), good stability under stressful conditions, solid test weight and grain quality, PCUE brings western bean cutworm + corn earworm protection<br>
                    <strong>Positioning:</strong> SUPER TOUGH PRODUCT - put in toughest plots, use for durability acres. Dryland to full irrigation. (If you want high yield, use P09076V instead)<br>
                    <strong>Considerations:</strong> Tops will break out but lower stalk quality is really good late into fall. Tends to purple early in colder conditions, moderate tiller in low pop<br>
                    <strong>Technology:</strong> PCUE, LL, RR2, Enlist, FOP
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P08215" onchange="saveNotes('P08215', this.value)" placeholder="Your notes: Super tough product - goes into toughest plots, use for durability acres."></textarea>
                </div>
            </div>
            <div class="hybrid-card" style="border-color:#ffc107;">
                <h3>P10705V <span class="crm-badge">110 CRM</span> <span style="background:#ffc107;color:#000;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.7rem;margin-left:0.5rem;">LIMITED LAUNCH</span></h3>
                <div class="replaces">Triple companion TO P10300PCE; Companions: P10625V, P12517V (<strong>P12517V LOVES OUR AREA</strong> - major player, +10 bu/a over P10705V)</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Positioning</div>
                        <div class="value">Full Irrigation</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Yield Potential</div>
                        <div class="value" style="color:#28a745;">Very High</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Drought</div>
                        <div class="value">7</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Test Weight</div>
                        <div class="value">5</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> 110 CRM Vorceed - top-end performance for irrigated acre, very high yield potential for well-managed acres, decent ear flex with chunky ear development, strong roots and mid-season brittle stalk. <strong style="color:#6c757d;">SILAGE: TOP PERFORMER in 108-112 CRM range! Best starch + yield (~28 t/a @ 35% DM)</strong><br>
                    <strong>Positioning:</strong> LIMITED TO FULL IRRIGATION - verify toughness under limited water in 2026<br>
                    <strong>Considerations:</strong> CONCERNS WITH EAR RETENTION - monitor closely. Avg BLS tolerance. Above avg rapid growth - LIMIT SU AND GROWTH REGULATORS. Tends to break tops at harvest, moderate tiller in low pop. WARNING: Stays green late - neighbors got burned by too much moisture at freeze<br>
                    <strong>Technology:</strong> V, LL, RR2, Enlist, FOP
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P10705" onchange="saveNotes('P10705', this.value)" placeholder="Your notes: Neighbors going hard into this - got burned by too green/moisture at freeze. DROP INTO HIGH YIELD PLOTS."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P11259PCE <span class="crm-badge">111 CRM</span> <span style="background:#007bff;color:white;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.7rem;margin-left:0.5rem;">AquaMax</span></h3>
                <div class="replaces"><strong>GOING AFTER P1122AML ACRES</strong>; Companions: P10625PCUE, P12517PCUE</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Drought Rating</div>
                        <div class="value" style="color:#28a745;">9 (Excellent)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Stress BLUP</div>
                        <div class="value" style="color:#28a745;">~162 bu/a (BEST)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Hi-Yield BLUP</div>
                        <div class="value" style="color:#28a745;">~250 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Test Weight</div>
                        <div class="value">6</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> TOP RIGHT ON CHART - BEST stress tolerance AND excellent yield. AquaMax with outstanding drought (9). Excellent stability low to high yield. Big chunky ears, nice western agronomic package<br>
                    <strong>Positioning:</strong> USE ON TOUGH TOUGH ACRES ALL THE WAY UP TO HIGH YIELD ENVIRONMENTS - dryland to full irrigation<br>
                    <strong>Considerations:</strong> MAIN CONCERN: WEAK ON SOUTHERN RUST (4) - monitor in high-pressure environments. Head smut (4)<br>
                    <strong>Technology:</strong> PCE, LL, RR2, Enlist, FOP
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P11259" onchange="saveNotes('P11259', this.value)" placeholder="Your notes: AquaMax - tough acre to top end..."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P14270V/PCE <span class="crm-badge">114 CRM</span> <span style="background:#6c757d;color:white;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.7rem;margin-left:0.5rem;">SILAGE</span></h3>
                <div class="replaces">Targeted Replacement: P14830AML (<strong>+2 Goss's improvement!</strong>), <strong>TAKING OUT P1828AM</strong>; Companion: P14364PCUE; Silage companions: P12517V, P12904V, P13777V, P15517V</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Stress BLUP</div>
                        <div class="value" style="color:#28a745;">~193 bu/a (BEST)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Hi-Yield BLUP</div>
                        <div class="value">~240 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Goss' Wilt</div>
                        <div class="value" style="color:#28a745;">7 (Outstanding)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Drought</div>
                        <div class="value">8</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> SILAGE PRODUCT - BIG BEAUTIFUL PLANT for silage. DUAL PURPOSE product with high quality silage. Great late-season staygreen. Solid drought (8), nice stability. Outstanding Goss' wilt for corn-on-corn. Above avg BLS. <strong>MORE STABLE PRODUCT THAN P13777V. +10.3 bu/a yield advantage over P14830AML!</strong><br>
                    <strong>Positioning:</strong> Wheat stubble dryland to full irrigation - verify dryland utility in 2026. Better in Valent Sands<br>
                    <strong>Considerations:</strong> Ears can be nosy under higher population - test populations in 2026. Heavier tiller in low pop<br>
                    <strong>Technology:</strong> V/PCE, LL, RR2, Enlist, FOP
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P14270" onchange="saveNotes('P14270', this.value)" placeholder="Your notes: Silage product..."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P15517V <span class="crm-badge">115 CRM</span> <span style="background:#6c757d;color:white;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.7rem;margin-left:0.5rem;">SILAGE</span></h3>
                <div class="replaces"><strong>Targeted Replacement: P1828AM</strong>; Silage companion to: P12904V, P12517V, P13777V, P14270V</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Drought</div>
                        <div class="value" style="color:#dc3545;">5 (WEAKNESS)</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Goss' Wilt</div>
                        <div class="value" style="color:#28a745;">7</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Silage Yield</div>
                        <div class="value" style="color:#28a745;">8</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Milk/Beef Per Acre</div>
                        <div class="value" style="color:#28a745;">8/8</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> <strong style="color:#dc3545;">SILAGE SILAGE SILAGE - THIS IS A SILAGE PRODUCT!</strong> 115 CRM. Good stress emergence for EARLY PLANTING. Good Goss's wilt (7). Sturdy western agronomic package (solid brittle 6, stress emergence 6, staygreen 6). Good late-season staygreen and intactness, solid late stalks. Acceptable plant/ear height for silage. HIGH QUALITY SILAGE. Fiber Digestibility 8, Starch+Sugar 7. <strong style="color:#dc3545;">DROUGHT IS A 5 - HAS TO HAS TO HAS TO HAVE WATER!</strong><br>
                    <strong>Positioning:</strong> <strong>KEEP IT ON THE BETTER ACRES!</strong> Better corn-on-corn dryland to full irrigation - verify dryland utility in 2026<br>
                    <strong>Considerations:</strong> Slightly below Pioneer standard for test weight. Slightly below avg Gray Leaf Spot (4) and Southern Rust (4) - monitor high pressure environments. Avg to slightly below avg BLS observed in 2025. <strong>For silage plant/ear height: P14270V might be better - TEST IT</strong><br>
                    <strong>Technology:</strong> V, LL, RR2, Enlist, FOP
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P15517" onchange="saveNotes('P15517', this.value)" placeholder="Your notes: Silage companion..."></textarea>
                </div>
            </div>
            <div class="hybrid-card">
                <h3>P18512V/PCE <span class="crm-badge">118 CRM</span> <span style="background:#28a745;color:white;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.7rem;margin-left:0.5rem;">GRAIN</span></h3>
                <div class="replaces">TBD</div>
                <div class="hybrid-specs">
                    <div class="spec-item">
                        <div class="label">Stress BLUP (V)</div>
                        <div class="value">~185 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Stress BLUP (PCE)</div>
                        <div class="value">~175 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Hi-Yield BLUP</div>
                        <div class="value">~232-234 bu/a</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Drought</div>
                        <div class="value">TBD</div>
                    </div>
                    <div class="spec-item">
                        <div class="label">Goss' Wilt</div>
                        <div class="value">TBD</div>
                    </div>
                </div>
                <p style="margin:1rem 0; color:#666; font-size:0.9rem;">
                    <strong>Key Strengths:</strong> GRAIN PRODUCT but <strong style="color:#6c757d;">ALSO TOP SILAGE PERFORMER in 112-118 CRM! (~28.5 t/a @ 35% DM - BEST in class!)</strong> Long season triple for silage<br>
                    <strong>Positioning:</strong> Dual purpose - grain OR silage<br>
                    <strong>Considerations:</strong> Awaiting full specs<br>
                    <strong>Technology:</strong> V, LL, RR2, Enlist, FOP
                </p>
                <div class="hybrid-notes">
                    <label>My Notes:</label>
                    <textarea id="notes-P18512" onchange="saveNotes('P18512', this.value)" placeholder="Your notes: Grain product..."></textarea>
                </div>
            </div>
            <!-- Links to other crop pages -->
            <div style="margin-top:2rem; padding:1rem; background:#f8f9fa; border-radius:8px; text-align:center;">
                <h3 style="margin-bottom:1rem; color:#666;">Other Crops</h3>
                <a href="sorghum.html" style="display:inline-block; padding:0.75rem 1.5rem; background:#8b4513; color:white; text-decoration:none; border-radius:4px; margin:0.5rem; font-weight:600;">Sorghum Hybrids</a>
            </div>
        </div>
        <div id="competitive" class="tab-content">
            <div class="section">
                <h2>Product Performance by Yield Zone</h2>
                <p style="color:#666; margin-bottom:1rem;">2025-2023, District CD, Pioneer vs Competition, +/- 3 CRM, <strong style="color:#1a5f2a;">>10 Comparisons per cell</strong></p>
                <div class="key-notes" style="background:#e8f5e9; border-color:#1a5f2a;">
                    <h4 style="color:#1a5f2a;">How to Read This Table</h4>
                    <ul style="color:#333;">
                        <li><strong style="color:#28a745;">Green (75%+):</strong> Strong performer - leads in this yield environment</li>
                        <li><strong style="color:#ffc107;">Yellow (50-74%):</strong> Competitive - holds its own vs competition</li>
                        <li><strong style="color:#dc3545;">Red (<50%):</strong> Weak spot - consider alternatives for this environment</li>
                    </ul>
                </div>
                <div class="data-table-container" style="max-height:none;">
                    <table id="yield-zone-table">
                        <thead>
                            <tr>
                                <th>Hybrid</th>
                                <th class="text-center">&lt;150 bu/a<br><span style="font-weight:normal;font-size:0.75rem;">%Wins</span></th>
                                <th class="text-center">150-200 bu/a<br><span style="font-weight:normal;font-size:0.75rem;">%Wins</span></th>
                                <th class="text-center">200-250 bu/a<br><span style="font-weight:normal;font-size:0.75rem;">%Wins</span></th>
                                <th class="text-center">&gt;250 bu/a<br><span style="font-weight:normal;font-size:0.75rem;">%Wins</span></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>P00549</strong></td>
                                <td class="text-center" style="background:#fff3cd;">63%</td>
                                <td class="text-center" style="background:#f8f9fa;">N/A</td>
                                <td class="text-center" style="background:#d4edda;">82%</td>
                                <td class="text-center" style="background:#fff3cd;">73%</td>
                            </tr>
                            <tr>
                                <td><strong>P02405</strong></td>
                                <td class="text-center" style="background:#f8d7da;">48%</td>
                                <td class="text-center" style="background:#fff3cd;">73%</td>
                                <td class="text-center" style="background:#fff3cd;">61%</td>
                                <td class="text-center" style="background:#d4edda;">80%</td>
                            </tr>
                            <tr>
                                <td><strong>P03115</strong></td>
                                <td class="text-center" style="background:#fff3cd;">65%</td>
                                <td class="text-center" style="background:#f8d7da;">38%</td>
                                <td class="text-center" style="background:#f8d7da;">41%</td>
                                <td class="text-center" style="background:#f8d7da;">41%</td>
                            </tr>
                            <tr style="background:#f0fff0;">
                                <td><strong>P03357</strong> ⭐</td>
                                <td class="text-center" style="background:#f8d7da;">47%</td>
                                <td class="text-center" style="background:#fff3cd;">63%</td>
                                <td class="text-center" style="background:#d4edda;">79%</td>
                                <td class="text-center" style="background:#28a745;color:white;font-weight:bold;">100%</td>
                            </tr>
                            <tr>
                                <td><strong>P03951</strong></td>
                                <td class="text-center" style="background:#f8d7da;">43%</td>
                                <td class="text-center" style="background:#fff3cd;">63%</td>
                                <td class="text-center" style="background:#fff3cd;">61%</td>
                                <td class="text-center" style="background:#d4edda;">89%</td>
                            </tr>
                            <tr>
                                <td><strong>P05081</strong></td>
                                <td class="text-center" style="background:#fff3cd;">51%</td>
                                <td class="text-center" style="background:#fff3cd;">66%</td>
                                <td class="text-center" style="background:#fff3cd;">74%</td>
                                <td class="text-center" style="background:#fff3cd;">70%</td>
                            </tr>
                            <tr>
                                <td><strong>P05466</strong></td>
                                <td class="text-center" style="background:#dc3545;color:white;">18%</td>
                                <td class="text-center" style="background:#d4edda;">88%</td>
                                <td class="text-center" style="background:#fff3cd;">70%</td>
                                <td class="text-center" style="background:#d4edda;">80%</td>
                            </tr>
                            <tr>
                                <td><strong>P08527</strong></td>
                                <td class="text-center" style="background:#fff3cd;">60%</td>
                                <td class="text-center" style="background:#d4edda;">78%</td>
                                <td class="text-center" style="background:#fff3cd;">72%</td>
                                <td class="text-center" style="background:#d4edda;">75%</td>
                            </tr>
                            <tr>
                                <td><strong>P0859</strong></td>
                                <td class="text-center" style="background:#fff3cd;">60%</td>
                                <td class="text-center" style="background:#d4edda;">83%</td>
                                <td class="text-center" style="background:#fff3cd;">74%</td>
                                <td class="text-center" style="background:#d4edda;">79%</td>
                            </tr>
                            <tr style="background:#f0fff0;">
                                <td><strong>P09076</strong> ⭐</td>
                                <td class="text-center" style="background:#d4edda;">82%</td>
                                <td class="text-center" style="background:#d4edda;">77%</td>
                                <td class="text-center" style="background:#d4edda;">90%</td>
                                <td class="text-center" style="background:#fff3cd;">64%</td>
                            </tr>
                            <tr>
                                <td><strong>P0995</strong></td>
                                <td class="text-center" style="background:#fff3cd;">56%</td>
                                <td class="text-center" style="background:#fff3cd;">71%</td>
                                <td class="text-center" style="background:#fff3cd;">61%</td>
                                <td class="text-center" style="background:#fff3cd;">69%</td>
                            </tr>
                            <tr style="background:#f0fff0;">
                                <td><strong>P10300</strong> ⭐</td>
                                <td class="text-center" style="background:#fff3cd;">63%</td>
                                <td class="text-center" style="background:#d4edda;">80%</td>
                                <td class="text-center" style="background:#d4edda;">89%</td>
                                <td class="text-center" style="background:#d4edda;">82%</td>
                            </tr>
                            <tr>
                                <td><strong>P10625</strong></td>
                                <td class="text-center" style="background:#fff3cd;">60%</td>
                                <td class="text-center" style="background:#fff3cd;">72%</td>
                                <td class="text-center" style="background:#d4edda;">75%</td>
                                <td class="text-center" style="background:#fff3cd;">74%</td>
                            </tr>
                            <tr>
                                <td><strong>P1122</strong></td>
                                <td class="text-center" style="background:#fff3cd;">63%</td>
                                <td class="text-center" style="background:#fff3cd;">58%</td>
                                <td class="text-center" style="background:#fff3cd;">57%</td>
                                <td class="text-center" style="background:#fff3cd;">68%</td>
                            </tr>
                            <tr>
                                <td><strong>P12393</strong></td>
                                <td class="text-center" style="background:#dc3545;color:white;">33%</td>
                                <td class="text-center" style="background:#d4edda;">90%</td>
                                <td class="text-center" style="background:#fff3cd;">68%</td>
                                <td class="text-center" style="background:#d4edda;">83%</td>
                            </tr>
                            <tr style="background:#f0fff0;">
                                <td><strong>P12517</strong> ⭐</td>
                                <td class="text-center" style="background:#f8d7da;">46%</td>
                                <td class="text-center" style="background:#d4edda;">75%</td>
                                <td class="text-center" style="background:#d4edda;">85%</td>
                                <td class="text-center" style="background:#d4edda;">91%</td>
                            </tr>
                            <tr>
                                <td><strong>P12904</strong></td>
                                <td class="text-center" style="background:#dc3545;color:white;">17%</td>
                                <td class="text-center" style="background:#fff3cd;">67%</td>
                                <td class="text-center" style="background:#fff3cd;">56%</td>
                                <td class="text-center" style="background:#fff3cd;">69%</td>
                            </tr>
                            <tr>
                                <td><strong>P13777</strong></td>
                                <td class="text-center" style="background:#f8d7da;">45%</td>
                                <td class="text-center" style="background:#f8d7da;">46%</td>
                                <td class="text-center" style="background:#d4edda;">79%</td>
                                <td class="text-center" style="background:#d4edda;">78%</td>
                            </tr>
                            <tr style="background:#f0fff0;">
                                <td><strong>P14364</strong> ⭐</td>
                                <td class="text-center" style="background:#d4edda;">80%</td>
                                <td class="text-center" style="background:#28a745;color:white;font-weight:bold;">100%</td>
                                <td class="text-center" style="background:#d4edda;">85%</td>
                                <td class="text-center" style="background:#d4edda;">89%</td>
                            </tr>
                            <tr>
                                <td><strong>P14830</strong></td>
                                <td class="text-center" style="background:#dc3545;color:white;">20%</td>
                                <td class="text-center" style="background:#fff3cd;">72%</td>
                                <td class="text-center" style="background:#d4edda;">88%</td>
                                <td class="text-center" style="background:#fff3cd;">74%</td>
                            </tr>
                            <tr>
                                <td><strong>P1548</strong></td>
                                <td class="text-center" style="background:#f8f9fa;">N/A</td>
                                <td class="text-center" style="background:#f8d7da;">47%</td>
                                <td class="text-center" style="background:#fff3cd;">54%</td>
                                <td class="text-center" style="background:#dc3545;color:white;">27%</td>
                            </tr>
                            <tr>
                                <td><strong>P1742</strong></td>
                                <td class="text-center" style="background:#f8f9fa;">N/A</td>
                                <td class="text-center" style="background:#d4edda;">86%</td>
                                <td class="text-center" style="background:#fff3cd;">71%</td>
                                <td class="text-center" style="background:#d4edda;">82%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top:1.5rem; padding:1rem; background:#fff3cd; border:1px solid #ffc107; border-radius:8px;">
                    <h4 style="color:#856404; margin-bottom:0.5rem;">Key Takeaways</h4>
                    <ul style="color:#856404; margin-left:1.5rem;">
                        <li><strong>P03357:</strong> 100% wins at >250 bu/a - DOMINANT in high-yield environments</li>
                        <li><strong>P14364:</strong> 100% wins at 150-200 bu/a, strong across ALL zones (80%+ everywhere)</li>
                        <li><strong>P09076:</strong> Best dryland performer (82% at <150), excellent mid-range (90% at 200-250)</li>
                        <li><strong>P12517:</strong> Strong high-yield (91% at >250, 85% at 200-250)</li>
                        <li><strong>P10300:</strong> Consistent performer - 80%+ in top 3 yield zones</li>
                        <li><strong style="color:#dc3545;">Avoid P03115, P1548 in high-yield environments</strong></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <script>
        // EMBEDDED REAL DATA - 574 records from 2024-2026
        const data = {
            records: [
                {operation: "Anderson Wheat Farms", hybrid: "P0075AM", year: 2024, bags: 112},
                {operation: "Anderson Wheat Farms", hybrid: "P0075AM", year: 2025, bags: 50},
                {operation: "Anderson Wheat Farms", hybrid: "P0075AM", year: 2026, bags: 83},
                {operation: "Anderson Wheat Farms", hybrid: "P0075Q", year: 2024, bags: 80},
                {operation: "Anderson Wheat Farms", hybrid: "P0075Q", year: 2025, bags: 3},
                {operation: "Anderson Wheat Farms", hybrid: "P03115PCE", year: 2024, bags: 2},
                {operation: "Anderson Wheat Farms", hybrid: "P03115V", year: 2025, bags: 85},
                {operation: "Anderson Wheat Farms", hybrid: "P03115V", year: 2026, bags: 43},
                {operation: "Anderson Wheat Farms", hybrid: "P0339Q", year: 2024, bags: 85},
                {operation: "Anderson Wheat Farms", hybrid: "P05466Q", year: 2024, bags: 58},
                {operation: "Anderson Wheat Farms", hybrid: "P05466V", year: 2024, bags: 2},
                {operation: "Anderson Wheat Farms", hybrid: "P05466V", year: 2025, bags: 132},
                {operation: "Anderson Wheat Farms", hybrid: "P05466V", year: 2026, bags: 53},
                {operation: "Anderson Wheat Farms", hybrid: "P07340Q", year: 2024, bags: 2},
                {operation: "Anderson Wheat Farms", hybrid: "P08527V", year: 2024, bags: 2},
                {operation: "Anderson Wheat Farms", hybrid: "P0859AM", year: 2024, bags: 54},
                {operation: "Anderson Wheat Farms", hybrid: "P0859AM", year: 2025, bags: 55},
                {operation: "Anderson Wheat Farms", hybrid: "P0924Q", year: 2024, bags: 2},
                {operation: "Anderson Wheat Farms", hybrid: "P13777V", year: 2025, bags: 45},
                {operation: "Anderson Wheat Farms", hybrid: "P13777V", year: 2026, bags: 53},
                {operation: "Anderson Wheat Farms", hybrid: "P1828Q", year: 2024, bags: 60},
                {operation: "Anderson Wheat Farms", hybrid: "P9489AM", year: 2024, bags: 32},
                {operation: "Anderson Wheat Farms", hybrid: "P9489AM", year: 2025, bags: 50},
                {operation: "Arrow Head", hybrid: "P0339Q", year: 2024, bags: 50},
                {operation: "Arrow Head", hybrid: "P05081AML", year: 2026, bags: 50},
                {operation: "Arrow Head", hybrid: "P05466V", year: 2025, bags: 52},
                {operation: "Arrow Head", hybrid: "P0622AML", year: 2024, bags: 48},
                {operation: "Arrow Head", hybrid: "P08527V", year: 2026, bags: 100},
                {operation: "Bamford Farms", hybrid: "P0075AM", year: 2024, bags: 40},
                {operation: "Bamford Farms", hybrid: "P0075AM", year: 2025, bags: 40},
                {operation: "Bamford Farms", hybrid: "P0075AM", year: 2026, bags: 37},
                {operation: "Bamford Farms", hybrid: "P0157AMXT", year: 2026, bags: 77},
                {operation: "Bamford Farms", hybrid: "P03115V", year: 2025, bags: 52},
                {operation: "Bamford Farms", hybrid: "P0339Q", year: 2024, bags: 53},
                {operation: "Bamford Farms", hybrid: "P05081AML", year: 2025, bags: 50},
                {operation: "Bamford Farms", hybrid: "P05081AML", year: 2026, bags: 50},
                {operation: "Bamford Farms", hybrid: "P05466V", year: 2025, bags: 41},
                {operation: "Bamford Farms", hybrid: "P0622AML", year: 2024, bags: 52},
                {operation: "Bamford Farms", hybrid: "P0622AML", year: 2025, bags: 50},
                {operation: "Bamford Farms", hybrid: "P08527V", year: 2025, bags: 54},
                {operation: "Bamford Farms", hybrid: "P08527V", year: 2026, bags: 44},
                {operation: "Bamford Farms", hybrid: "P0924Q", year: 2024, bags: 42},
                {operation: "Bamford Farms", hybrid: "P1089AMXT", year: 2024, bags: 42},
                {operation: "Bamford Farms", hybrid: "P1122AML", year: 2026, bags: 55},
                {operation: "Bamford Farms", hybrid: "P1244AM", year: 2026, bags: 15},
                {operation: "Bamford Farms", hybrid: "P12517V", year: 2026, bags: 25},
                {operation: "Bamford Farms", hybrid: "P1548AM", year: 2026, bags: 15},
                {operation: "Bamford Farms", hybrid: "P9845AM", year: 2024, bags: 10},
                {operation: "Bamford Farms", hybrid: "P9845PCE", year: 2025, bags: 66},
                {operation: "Boerner - Dryland Farms LLC", hybrid: "35F50AM", year: 2024, bags: 16},
                {operation: "Boerner - Dryland Farms LLC", hybrid: "P0075AM", year: 2024, bags: 19},
                {operation: "Boerner - Dryland Farms LLC", hybrid: "P0075AM", year: 2025, bags: 28},
                {operation: "Boerner - Dryland Farms LLC", hybrid: "P0075AM", year: 2026, bags: 30},
                {operation: "Boerner - Dryland Farms LLC", hybrid: "P1151AM", year: 2025, bags: 16},
                {operation: "Boerner Farms", hybrid: "P0075AM", year: 2024, bags: 43},
                {operation: "Boerner Farms", hybrid: "P0075AM", year: 2025, bags: 9},
                {operation: "Boerner Farms", hybrid: "P0157AMXT", year: 2025, bags: 26},
                {operation: "Boerner Farms", hybrid: "P0157AMXT", year: 2026, bags: 30},
                {operation: "Boerner Farms", hybrid: "P0339Q", year: 2024, bags: 6},
                {operation: "Boerner Farms", hybrid: "P0487Q", year: 2024, bags: 20},
                {operation: "Boerner Farms", hybrid: "P0487Q", year: 2026, bags: 30},
                {operation: "Boerner Farms", hybrid: "P05081AML", year: 2026, bags: 10},
                {operation: "Boerner Farms", hybrid: "P0622AML", year: 2024, bags: 36},
                {operation: "Boerner Farms", hybrid: "P0622AML", year: 2025, bags: 36},
                {operation: "Boerner Farms", hybrid: "P0622AML", year: 2026, bags: 30},
                {operation: "Boerner Farms", hybrid: "P1151AM", year: 2025, bags: 36}
            ],
            new2027: ['P96567V', 'P96567PCE', 'P99491V', 'P99491PCE', 'P03802PCE', 'P04651V', 'P08215PCUE', 'P10705V', 'P11259PCE', 'P14270V', 'P14270PCE', 'P15517V', 'P18512V', 'P18512PCE'],
            hybridNotes: {}
        };
        // Load notes from localStorage
        const savedNotes = localStorage.getItem('pioneerHybridNotes');
        if (savedNotes) {
            data.hybridNotes = JSON.parse(savedNotes);
            document.querySelectorAll('textarea[id^="notes-"]').forEach(ta => {
                const key = ta.id.replace('notes-', '');
                if (data.hybridNotes[key]) ta.value = data.hybridNotes[key];
            });
        }
        function saveNotes(hybrid, value) {
            data.hybridNotes[hybrid] = value;
            localStorage.setItem('pioneerHybridNotes', JSON.stringify(data.hybridNotes));
        }
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }
        function renderAll() {
            renderSummary();
            renderByOperation();
            renderByHybrid();
            renderDetail();
        }
        function renderSummary() {
            const totals = {2024: 0, 2025: 0, 2026: 0};
            data.records.forEach(r => {
                if (totals[r.year] !== undefined) totals[r.year] += r.bags;
            });
            let total2027 = 0;
            const hybridTotals = getHybridTotals();
            Object.keys(hybridTotals).forEach(h => { total2027 += hybridTotals[h].predicted; });
            document.getElementById('total-2024').textContent = totals[2024].toLocaleString();
            document.getElementById('total-2025').textContent = totals[2025].toLocaleString();
            document.getElementById('total-2026').textContent = totals[2026].toLocaleString();
            document.getElementById('total-2027').textContent = total2027.toLocaleString();
        }
        function renderByOperation() {
            const filter = (document.getElementById('filter-operation')?.value || '').toLowerCase();
            const operations = getOperationTotals();
            const tbody = document.getElementById('operation-table');
            let html = '';
            Object.keys(operations).sort().forEach(op => {
                if (filter && !op.toLowerCase().includes(filter)) return;
                const d = operations[op];
                const change = d.y2026 > 0 ? ((d.predicted - d.y2026) / d.y2026 * 100).toFixed(1) : 0;
                const changeClass = change >= 0 ? 'change-up' : 'change-down';
                html += `<tr><td><strong>${op}</strong></td><td class="text-right">${d.y2024 || '-'}</td><td class="text-right">${d.y2025 || '-'}</td><td class="text-right">${d.y2026 || '-'}</td><td class="text-right prediction">${d.predicted}</td><td class="text-right ${changeClass}">${change >= 0 ? '+' : ''}${change}%</td></tr>`;
            });
            tbody.innerHTML = html || '<tr><td colspan="6">No data</td></tr>';
        }
        function renderByHybrid() {
            const filter = (document.getElementById('filter-hybrid')?.value || '').toLowerCase();
            const hybrids = getHybridTotals();
            const tbody = document.getElementById('hybrid-table');
            let grandTotal = 0;
            Object.values(hybrids).forEach(h => { grandTotal += h.predicted; });
            let html = '';
            Object.keys(hybrids).sort().forEach(hybrid => {
                if (filter && !hybrid.toLowerCase().includes(filter)) return;
                const d = hybrids[hybrid];
                const pct = grandTotal > 0 ? (d.predicted / grandTotal * 100).toFixed(1) : 0;
                html += `<tr><td><strong>${hybrid}</strong></td><td class="text-right">${d.y2024 || '-'}</td><td class="text-right">${d.y2025 || '-'}</td><td class="text-right">${d.y2026 || '-'}</td><td class="text-right prediction">${d.predicted}</td><td class="text-right">${pct}%</td></tr>`;
            });
            tbody.innerHTML = html || '<tr><td colspan="6">No data</td></tr>';
        }
        function renderDetail() {
            const filter = (document.getElementById('filter-detail')?.value || '').toLowerCase();
            const details = getDetailData();
            const tbody = document.getElementById('detail-table');
            let html = '';
            details.forEach(d => {
                if (filter && !d.operation.toLowerCase().includes(filter) && !d.hybrid.toLowerCase().includes(filter)) return;
                html += `<tr><td>${d.operation}</td><td>${d.hybrid}</td><td class="text-right">${d.y2024 || '-'}</td><td class="text-right">${d.y2025 || '-'}</td><td class="text-right">${d.y2026 || '-'}</td><td class="text-right prediction">${d.predicted}</td></tr>`;
            });
            tbody.innerHTML = html || '<tr><td colspan="6">No data</td></tr>';
        }
        function getOperationTotals() {
            const ops = {};
            data.records.forEach(r => {
                if (!ops[r.operation]) ops[r.operation] = {y2024: 0, y2025: 0, y2026: 0, predicted: 0};
                if (r.year === 2024) ops[r.operation].y2024 += r.bags;
                if (r.year === 2025) ops[r.operation].y2025 += r.bags;
                if (r.year === 2026) ops[r.operation].y2026 += r.bags;
            });
            Object.keys(ops).forEach(op => { ops[op].predicted = predictValue(ops[op].y2024, ops[op].y2025, ops[op].y2026); });
            return ops;
        }
        function getHybridTotals() {
            const hybrids = {};
            data.records.forEach(r => {
                if (!hybrids[r.hybrid]) hybrids[r.hybrid] = {y2024: 0, y2025: 0, y2026: 0, predicted: 0};
                if (r.year === 2024) hybrids[r.hybrid].y2024 += r.bags;
                if (r.year === 2025) hybrids[r.hybrid].y2025 += r.bags;
                if (r.year === 2026) hybrids[r.hybrid].y2026 += r.bags;
            });
            Object.keys(hybrids).forEach(h => { hybrids[h].predicted = predictValue(hybrids[h].y2024, hybrids[h].y2025, hybrids[h].y2026); });
            return hybrids;
        }
        function getDetailData() {
            const detail = {};
            data.records.forEach(r => {
                const key = `${r.operation}|${r.hybrid}`;
                if (!detail[key]) detail[key] = {operation: r.operation, hybrid: r.hybrid, y2024: 0, y2025: 0, y2026: 0};
                if (r.year === 2024) detail[key].y2024 += r.bags;
                if (r.year === 2025) detail[key].y2025 += r.bags;
                if (r.year === 2026) detail[key].y2026 += r.bags;
            });
            return Object.values(detail).map(d => {
                d.predicted = predictValue(d.y2024, d.y2025, d.y2026);
                return d;
            }).sort((a, b) => a.operation.localeCompare(b.operation) || a.hybrid.localeCompare(b.hybrid));
        }
        function predictValue(y2024, y2025, y2026) {
            const MAX_GROWTH = 0.25;
            const MAX_DECLINE = -0.30;
            if (y2026) {
                if (y2025 && y2026) {
                    const recentChange = y2025 > 0 ? (y2026 - y2025) / y2025 : 0;
                    const clampedChange = Math.max(MAX_DECLINE, Math.min(MAX_GROWTH, recentChange));
                    const dampedChange = clampedChange * 0.5;
                    return Math.max(0, Math.round(y2026 * (1 + dampedChange)));
                }
                return Math.round(y2026 * 1.02);
            } else if (y2025) {
                if (y2024) {
                    const change = y2024 > 0 ? (y2025 - y2024) / y2024 : 0;
                    if (change < -0.3) {
                        return Math.round(y2025 * 0.5);
                    }
                }
                return Math.round(y2025 * 0.8);
            } else if (y2024) {
                return Math.round(y2024 * 0.3);
            }
            return 0;
        }
        function printDetailView() {
            document.getElementById('print-2024').textContent = document.getElementById('total-2024').textContent;
            document.getElementById('print-2025').textContent = document.getElementById('total-2025').textContent;
            document.getElementById('print-2026').textContent = document.getElementById('total-2026').textContent;
            document.getElementById('print-2027').textContent = document.getElementById('total-2027').textContent;
            document.getElementById('detail').classList.add('print-active');
            window.print();
            setTimeout(() => {
                document.getElementById('detail').classList.remove('print-active');
            }, 100);
        }
        function exportData() {
            let csv = 'Operation,Hybrid,2024,2025,2026,2027 Predicted\n';
            const details = getDetailData();
            details.forEach(d => {
                csv += `"${d.operation}","${d.hybrid}",${d.y2024 || 0},${d.y2025 || 0},${d.y2026 || 0},${d.predicted}\n`;
            });
            const blob = new Blob([csv], {type: 'text/csv'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'pioneer_2027_forecast.csv';
            a.click();
        }
        renderAll();
    </script>
</body>
</html>
